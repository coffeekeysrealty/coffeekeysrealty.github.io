<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Properties for Sale</title>
  <style>
    /* Your existing styles here */
  </style>
</head>
<body>
  <div class="container">
    <h1>Properties for Sale</h1>
    <div class="scroll-container">
      <div class="property-grid" id="propertyGrid">
        <div class="text-center w-full">Loading properties...</div>
      </div>
    </div>
  </div>

  <script>
    let currentPosition = 0;
    let properties = [];
    let autoScrollInterval;

    document.addEventListener('DOMContentLoaded', async function() {
      loadProperties();
    });

    async function loadProperties() {
      const url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSvr7WG5UXsbz_i5hFLeuN5uXliGrNmmwXuraurDm6nMf-JZ-3b_34_En-0LidajhOVrnFuTP4UorNU/pub?gid=0&single=true&output=csv';
  
      try {
        const response = await fetch(url);
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        const csvText = await response.text();
        properties = parseCSV(csvText);
        renderProperties(properties);
        startAutoScroll();
      } catch (error) {
        console.error('Error loading properties:', error);
        document.getElementById('propertyGrid').innerHTML = `
          <div class="text-center w-full">
            <p style="color: #ff6b6b;">Unable to load properties. Please try again later.</p>
          </div>
        `;
      }
    }

    function parseCSV(csv) {
      // Your existing parsing logic here
    }

    function renderProperties(properties) {
      const grid = document.getElementById('propertyGrid');
      grid.innerHTML = properties.map(property => `
        <div class="property-card">
          <img
            src="${property['Image URL'] || '/api/placeholder/400/300'}"
            alt="${property.Type || 'Property'}"
            class="property-image"
            onerror="this.src='/api/placeholder/400/300'"
          >
          <div class="divider"></div>
          <h2 class="property-type">${property.Type || ''}</h2>
          <p class="property-location">${property.Location || ''}</p>
          <p class="property-details">
            ${property.Beds} ${property.Size ? '| ' + property.Size : ''}
          </p>
          ${property.Feature ? `<p class="property-details">${property.Feature}</p>` : ''}
          ${property.Details ? `<p class="accessibility-info">${property.Details}</p>` : ''}
          <div class="divider"></div>

          <a href="${property['Details URL'] || '#'}">Click for More Photos</a>
        </div>
      `).join('');
    }

    function startAutoScroll() {
      // Your existing auto-scroll logic here
    }
  </script>
</body>
</html>
